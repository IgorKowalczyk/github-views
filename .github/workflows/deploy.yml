name: Deploy

on: [push, pull_request]

jobs:
  deploy:
    name: Deploy
    runs-on: ubuntu-latest
    strategy:
     fail-fast: false
     matrix:
      language: ["javascript"]
      node: ["18.x"]
    permissions:
      id-token: write
      contents: read
    steps:
      - name: ðŸ§± Checkout repository
        uses: actions/checkout@v3
      - name: ðŸ”© Setup PNPM
        uses: pnpm/action-setup@v2
        with:
         version: latest
      - name: ðŸ”© Setup Node ${{ matrix.node }}
        uses: actions/setup-node@v3
        with:
         node-version: ${{ matrix.node }}
         cache: "pnpm"
      - name: ðŸš€ Install dependencies
        run: pnpm install
      - name: ðŸš€ Build project
        run: pnpm run build
      - name: ðŸš€ Upload to Deno Deploy
        uses: denoland/deployctl@v1
        with:
          project: "real-seal-38"
          entrypoint: "server/entry.mjs"
          root: "dist"
